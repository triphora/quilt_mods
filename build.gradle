//file:noinspection UnnecessaryQualifiedReference
plugins {
  id "fabric-loom" version "0.10.+"
  id "com.modrinth.minotaur" version "1.2.+"
  id "org.cadixdev.licenser" version "0.6.+"
}

String minecraft_version = "1.17.1"   // https://fabricmc.net/versions.html
String yarn_mappings = "61"           // https://fabricmc.net/versions.html
String loader_version = "0.12.2"      // https://fabricmc.net/versions.html
String fabric_version = "0.40.8+1.17" // https://fabricmc.net/versions.html
String modmenu_version = "2.0.14"     // https://modrinth.com/mod/modmenu/versions

archivesBaseName = "clean-logs"
version = loom.modVersion

repositories {
  maven { url "https://maven.quiltmc.org/repository/release/" }
  maven { url "https://maven.terraformersmc.com" }
}

dependencies {
  minecraft "com.mojang:minecraft:${minecraft_version}"
  mappings "net.fabricmc:yarn:${minecraft_version}+build.${yarn_mappings}:v2"
  modImplementation "net.fabricmc:fabric-loader:${loader_version}"
  modImplementation "net.fabricmc.fabric-api:fabric-api:${fabric_version}"

  modImplementation "com.terraformersmc:modmenu:${modmenu_version}"

  implementation include('com.moandjiezana.toml:toml4j:0.7.2')
}

tasks.withType(JavaCompile) {
  it.options.encoding = "UTF-8"
}

jar {
  from("LICENSE")
}

license {
  header = rootProject.file('HEADER')
}

Set<String> supported_mc_versions = [ "1.17.1", "1.16.5", "1.16.1", "1.15.2", "1.14.4" ]

task modrinth(type: com.modrinth.minotaur.TaskModrinthUpload) {
  onlyIf { System.getenv("MODRINTH") }
  token = System.getenv("MODRINTH")
  projectId = "OTteoJUk"
  versionNumber = version
  versionType = "RELEASE"
  uploadFile = remapJar
  supported_mc_versions.each {
    String gameVersion -> addGameVersion gameVersion
  }
  addLoader "fabric"
}
